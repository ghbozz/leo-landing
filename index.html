<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css">
  <!--   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css"> -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" /> -->
    <link rel="stylesheet" href="./assets/style.css">
  <title>Saint Lanvain</title>
</head>
<body>
  <nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://bulma.io">
        <img src="https://bulma.io/images/bulma-logo.png" width="112" height="28">
      </a>

      <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div class="navbar-end">
      <div id="navbarBasicExample" class="navbar-menu">
        <div class="navbar-start">
          <a class="navbar-item">
            Music
          </a>

          <a class="navbar-item">
            Tour
          </a>
        </div>
      </div>
    </div>


  </nav>

  <!-- HERO -->
  <section class="hero is-fullheight-with-navbar">
    <div class="hero-body">
      <div class="container home-container">

        <div class="player-wrapper">

          <div class="player-img" style="background-image: url('assets/images/thomax-1.jpg');">
          </div>

          <div class="control-wrapper">
            <div class="current-track"></div>
            <div class="timeline">
              <div class="progress"></div>
            </div>
            <div class="player-btns">
              <button class="player-control" id="play" onclick="document.getElementById('player').play()"><i class="fas fa-play"></i></button>
              <button class="player-control" id="pause" onclick="document.getElementById('player').pause()"><i class="fas fa-pause"></i></button>
            </div>
            <audio id="player" src="assets/audio/thomax-1.mp3"></audio>
          </div>

          <div class="tracks-wrapper">
            <ul class="tracks">
              <li class="track">thomax-1</li>
              <li class="track">thomax-2</li>
              <li class="track">thomax-3</li>
            </ul>
          </div>

        </div>

      </div>
    </div>
  </section>

  <script>
    const initPlayer = () => {
      const tracks = document.querySelectorAll('.track')
      tracks.forEach((track) => {
        track.addEventListener('click', (e) => {
          setTrack(track);
          toggleActive(tracks, e)
        })
      })
    }

    const setTrack = (track) => {
      document.getElementById('player').src = `assets/audio/${track.innerText}.mp3`
      document.querySelector('.player-img').style.backgroundImage = `url('assets/images/${track.innerText}.jpg')`
      document.querySelector('.current-track').innerText = `${track.innerText}`
      document.getElementById('play').click();
      setInterval(progressBar, 500)
    }

    const toggleActive = (tracks, e) => {
      tracks.forEach((track) => {
        track.classList.remove('active')
      })
      e.currentTarget.classList.add('active')
    }

    const nextTrack = () => {
      const currentTrack = document.querySelector('.active')
      if (currentTrack.nextElementSibling) {
        currentTrack.classList.remove('active')
        currentTrack.nextElementSibling.classList.add('active')
        setTrack(currentTrack.nextElementSibling)
      } else {
        setTrack(document.querySelectorAll('.track')[0])
      }
    }

    const progressBar = () => {
      const progress = document.querySelector('.progress')
      const player = document.getElementById('player')
      const calc = (100 * player.currentTime) / player.duration
      calc < 99.9 ? progress.style.width = `${calc}%` : nextTrack()
    }

    initPlayer();
  </script>
</body>
</html>
